<html>
<head>
<title>Numerical Solvers</title>
</head><body>
<p><h2>Numerical Solvers</h2></p>
<p>
	The Virtual Cell converts the biological description defined in a BioModel into a corresponding mathematical system of equations (e.g. ordinary and/or partial differential equations), 
	VCell will then solve the equations by applying numerical solvers to perform and analyze simulations. 
	</p>
<p>
	In Virtual Cell, numerical solvers can be divided into the following 4 types.
	<p><b>Deterministic Compartmental Solvers</b></p>
<p>
	The compartmental simulation executes a single point simulation based on the defined physiological model, the geometric assumptions, and structure sizes or surface to volume ratios and
	volume fractions. The ordinary differential equations (ODE), for single point approximations, representing the reactions kinetics are generated and passed to an interpreted ODE solver.
	The set of nonlinear ODE equations are typically solved in seconds. It allows an interactive modification of parameters and a quick determination of the effect over time. In addition,
	the Virtual Cell software computes the local sensitivity (Sensitivity Analysis) of any species concentration to any parameter as a function of time evaluated at the nominal solution.
	</p>
<ul><li>Forward Euler (First Order, Fixed Time Step)</li>
<p>Forward Euler method is a fixed time step mehtod to solve ordinary differential equations.</p>
<p></p>
<li>Runge-Kutta (Second Order, Fixed Time Step) -and- Runge-Kutta (Fourth Order, Fixed Time Step)</li>
<p>The Runge Kutta methods provide further systematic improvement in the spirit of the modified Euler method. Second order fixed time step method is also called the midpoint method.</p>
<p></p>
<li>Adams-Moulton (Fifth Order, Fixed Time Step)</li>
<p>The methods such as Foward Euler, Runge-Kutta etc. are called single-step methods because they use only the information from one previous point to compute the successive point. Adams-Moulton methods are explicit linear multistep methods that depend on multiple previous solution points to generate a new approximate solution point. It is a fixed time step method.</p>
<p></p>
<li>Runge-Kutta-Fehlberg (Fifth Order, Variable Time Step)</li>
<p>The Runge-Kutta-Fehlberg integrator is primarily designed to solve non-stiff and mildly stiff differential equations when derivative evaluations are inexpensive. It should generally not be used when the user is demanding high accuracy. It is a variable time step method.</p>
<p></p>
<li>CVODE (Variable Order, Variable Time Step)</li>
<p>CVODE is used for solving initial value problems for ordinary differential equations. It solves both stiff and nonstiff systems, using variable-coefficient Adams and BDF methods. In the stiff case, options for treating the Jacobian of the system include dense and band matrix solvers, and a preconditioned Krylov (iterative) solver. In the highly modular organization of CVODE, the core integrator module is independent of the linear system solvers, and all operations on N-vectors are isolated in a module of vector kernels.</p>
<p></p>
<li>Combined Stiff Solver (IDA/CVODE)</li>
<p>This chooses between IDA and CVODE depending on the problem to be solved.</p>
<li>IDA (Variable Order, Variable Time Step, ODE/DAE)</li>
<p>IDA addresses systems of differential-algebraic equations (DAEs), and uses Backward Differentiation Formula methods. ODEs are a subset of DAEs, therefore IDA may be used for solving ODEs.</p>
</ul>
<p><b>Stochastic Compartmental Solvers</b></p>
<p>
	Different numerical methods are required to simulate different biological systems. Deterministic simulation is valid as long as the concentrations of simulated populations are high.
	However, the concentrations of these factors could be very low in living cells. In these latter cases, the biology is more accurately simulated by discrete approaches. As a result,
	stochastic simulation has been implemented in Virtual Cell to allow users to describe the discrete nature of changes in cell systems.
	</p>
<ul><li>Gibson (Next Reaction Stochastic Method)</li>
<p>Gibson-Bruck is an improved exact stochastic method based on Gillespie's SSA. It uses only a single random number per simulation event and takes time proportional to the logarithm of the number of reactions. Better performance is also acheived by utilizing a dependency graph and an indexed priority queue.</p>
<p></p>
<li>Hybrid (Gibson + Euler-Maruyama Method)</li>
<p>This is a hybrid stochastic method. It partitions the system into subsets of fast and slow reactions and approximates the fast reactions as a continuous Markov process, using a chemical Langevin equation, and accurately describes the slow dynamics using the Gibson algorithm. Fixed time step Euler-Maruyama is used for approximate numerical solution of CLE.</p>
<p></p>
<li>Hybrid (Gibson + Milstein Method)</li>
<p>This is a hybrid stochastic method. It partitions the system into subsets of fast and slow reactions and approximates the fast reactions as a continuous Markov process, using a chemical Langevin equation, and accurately describes the slow dynamics using the Gibson algorithm. Fixed time step Milstein is used for approximate numerical solution of CLE.</p>
<p></p>
<li>Hybrid (Adaptive Gibson + Milstein Method)</li>
<p>This is a hybrid stochastic method. It partitions the system into subsets of fast and slow reactions and approximates the fast reactions as a continuous Markov process, using a chemical Langevin equation, and accurately describes the slow dynamics using the Gibson algorithm. Adaptive time step Milstein is used for approximate numerical solution of CLE.</p>
</ul>
<p>
	Note: to exercise hybrid solvers you need to go to species specifications and check the checkbox for "Force Continuous" for at least one species.  See <a href="../Specifications/SpeciesSpecifications.html">Species Specifications.</a></p>
<p><b>Deterministic Spatial Solvers</b></p>
<p>Virtual Cell uses the finite volume method to deterministically solve spatial problems. The finite volume method is a method of spatial discretization of partial differential equations
	which exactly preserves conservation laws. Similar to the finite difference method, values are calculated at discrete places on a meshed geometry. The standalone version
	of the finite volume method is a little slower but gives better error messages.
	</p>
<ul><li>Semi-Implicit Finite Volume Compiled, Regular Grid (Fixed Time Step)(DISABLED)</li>
<p><b>(NO LONGER AVAILABLE - use Semi-Implicit Finite Volume-Particle Hybrid, Regular Grid (Fixed Time Step)</b> instead).  It is possible to view results run in prior versions of Virtual Cell under this solver, but new simulations can't be run, nor can models that reference this solver be edited and saved. The finite volume method is a method for representing and evaluating partial differential equations as algebraic discretization equations which exactly preserves conservation laws. Similar to the finite difference method, values are calculated at discrete places on a meshed geometry.</p>
<p></p>
<li>Semi-Implicit Finite Volume-Particle Hybrid, Regular Grid (Fixed Time Step)</li>
<p>This was our interpreted standalone version of the finite volume method. The finite volume method is a method for representing and evaluating partial differential equations as algebraic discretization equations which exactly preserves conservation laws. Similar to the finite difference method, values were calculated at discrete places on a meshed geometry.</p>
<p></p>
<li>Fully-Implicit Finite Volume, Regular Grid (Variable Time Step)</li>
<p>This is our fully implicit, adaptive time step finite volume method. The finite volume method represents partial differential equations as algebraic discretization equations which exactly preserves conservation laws. Similar to the finite difference method, values are calculated at discrete places on a meshed geometry. This method employs Sundials stiff solver CVODE for time stepping (method of lines). Please note that relative and absolute tolerances affect the accuracy of time descritization only, therefore spatial discritization is the only significant source of solution error.</p>
</ul>
<p><b>Stochastic Spatial Solvers</b></p>
<ul><li>Smoldyn (Spatial Stochastic Simulator)</li>
<p>Virtual Cell incorporates the Smoldyn(Smoluchowski Dynamics) to stochastically solve spatial problems. Smoldyn is a Brownian dynamics simulator. It represents space as a 1-, 2-,
	 or 3-dimensional continuum, as opposed to a lattice, and it steps through time using finite length time steps. Smoldyn represents molecules as individual point-like particles and
	 membranes as infinitely thin surfaces. Smoldyn simulates molecular diffusion, chemical reactions between individual molecules, and a wide variety of molecule-surface interactions.
	 So far, Smoldyn has been used primarily for either detailed biophysics research problems, such as on diffusion-influenced reaction dynamics, or for investigating the effects of spatial
	 organization on simple biological systems, such as the Escherichia coli chemotaxis system.
	</p>
</ul>
</p>
</body>
</html>
